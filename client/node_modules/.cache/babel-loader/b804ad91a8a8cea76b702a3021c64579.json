{"ast":null,"code":"var _jsxFileName = \"/home/thomas/code/Lersoo/tutorial_maker/client/src/components/Steps/CreateStep.jsx\";\nimport React, { Component } from 'react';\nimport API from '../../utils/API';\nimport { Form, Input } from '../shared/formComponents';\nimport cloudinary from 'cloudinary-core';\nvar cl = new cloudinary.Cloudinary({\n  cloud_name: \"dimzs5mei\",\n  api_key: 364644314416264,\n  api_secret: 'kQDtRUz9b_BVccowXuRxHj4q-Tc',\n  secure: true\n});\nexport default class CreateStep extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeStepDescription = e => {\n      this.setState({\n        step_description: e.target.value\n      });\n    };\n\n    this.onChangeStepMedia = e => {\n      this.setState({\n        step_media: e.target.value\n      });\n    };\n\n    this.onSubmit = e => {\n      e.preventDefault();\n      const tutorialID = this.props.match.params.id;\n      const mediaFile = this.state.file;\n      cloudinary.uploader.upload(mediaFile, function (req, res) {\n        console.log(res);\n      });\n      const newStep = {\n        step_description: this.state.step_description,\n        step_media: this.state.step_media\n      };\n      API.createStep(tutorialID, newStep).then(res => {\n        console.log(res);\n        window.location.href = `/tutorials/${tutorialID}`;\n      }).catch(err => console.log(err));\n    };\n\n    this.state = {\n      step_description: '',\n      step_media: null\n    };\n  }\n\n  uploadFile(file) {\n    const cloudName = 'dimzs5mei';\n    const url = `https://api.cloudinary.com/v1_1/${cloudName}/upload`;\n    const xhr = new XMLHttpRequest();\n    const fd = new FormData();\n    xhr.open('POST', url, true);\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n    xhr.onreadystatechange = function (e) {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        // File uploaded successfully\n        const response = JSON.parse(xhr.responseText);\n        console.log(response); // https://res.cloudinary.com/cloudName/image/upload/v1483481128/public_id.jpg\n\n        const url = response.secure_url;\n      }\n    };\n\n    fd.append('upload_preset', unsignedUploadPreset);\n    fd.append('tags', 'browser_upload'); // Optional - add tag for image admin in Cloudinary\n\n    fd.append('file', file);\n    xhr.send(fd);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }\n    }, \"Create a new tutorial\"), /*#__PURE__*/React.createElement(Form, {\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      placeholder: \"Enter a description for this step\",\n      onChange: this.onChangeStepDescription,\n      value: this.state.step_description,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Input, {\n      type: \"file\",\n      placeholder: \"Choose an image\",\n      onChange: this.onChangeStepMedia,\n      value: this.state.step_media,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Input, {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["/home/thomas/code/Lersoo/tutorial_maker/client/src/components/Steps/CreateStep.jsx"],"names":["React","Component","API","Form","Input","cloudinary","cl","Cloudinary","cloud_name","api_key","api_secret","secure","CreateStep","constructor","props","onChangeStepDescription","e","setState","step_description","target","value","onChangeStepMedia","step_media","onSubmit","preventDefault","tutorialID","match","params","id","mediaFile","state","file","uploader","upload","req","res","console","log","newStep","createStep","then","window","location","href","catch","err","uploadFile","cloudName","url","xhr","XMLHttpRequest","fd","FormData","open","setRequestHeader","onreadystatechange","readyState","status","response","JSON","parse","responseText","secure_url","append","unsignedUploadPreset","send","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport API from '../../utils/API';\nimport { Form, Input } from '../shared/formComponents'\n\nimport cloudinary from 'cloudinary-core';\nvar cl = new cloudinary.Cloudinary({\n  cloud_name: \"dimzs5mei\",\n  api_key: 364644314416264,\n  api_secret: 'kQDtRUz9b_BVccowXuRxHj4q-Tc',\n  secure: true\n});\n\nexport default class CreateStep extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      step_description: '',\n      step_media: null\n    }\n  }\n\n  onChangeStepDescription = (e) => {\n    this.setState({ step_description: e.target.value })\n  };\n\n  onChangeStepMedia = (e) => {\n    this.setState({ step_media: e.target.value })\n  }\n\n  onSubmit = (e) => {\n    e.preventDefault();\n    const tutorialID = this.props.match.params.id;\n\n    const mediaFile = this.state.file;\n    cloudinary.uploader.upload(mediaFile, function (req, res) { console.log(res) });\n\n    const newStep = {\n      step_description: this.state.step_description,\n      step_media: this.state.step_media,\n    };\n\n    API.createStep(tutorialID, newStep)\n      .then(res => {\n        console.log(res)\n        window.location.href = `/tutorials/${tutorialID}`\n      })\n      .catch(err => console.log(err))\n  }\n\n  uploadFile(file) {\n    const cloudName = 'dimzs5mei';\n    const url = `https://api.cloudinary.com/v1_1/${cloudName}/upload`;\n    const xhr = new XMLHttpRequest();\n    const fd = new FormData();\n    xhr.open('POST', url, true);\n    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n    xhr.onreadystatechange = function (e) {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        // File uploaded successfully\n        const response = JSON.parse(xhr.responseText);\n        console.log(response);\n\n        // https://res.cloudinary.com/cloudName/image/upload/v1483481128/public_id.jpg\n        const url = response.secure_url;\n      }\n    };\n\n    fd.append('upload_preset', unsignedUploadPreset);\n    fd.append('tags', 'browser_upload'); // Optional - add tag for image admin in Cloudinary\n    fd.append('file', file);\n    xhr.send(fd);\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>Create a new tutorial</h2>\n        <Form onSubmit={this.onSubmit}>\n          <Input\n            type='text'\n            placeholder=\"Enter a description for this step\"\n            onChange={this.onChangeStepDescription}\n            value={this.state.step_description}\n          />\n          <Input\n            type='file'\n            placeholder='Choose an image'\n            onChange={this.onChangeStepMedia}\n            value={this.state.step_media}\n          />\n          <Input type='submit' />\n        </Form>\n      </div>\n\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}